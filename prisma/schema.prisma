generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider     = "postgresql"
  url          = env("DATABASE_URL")
  relationMode = "foreignKeys"
}

model SavingsGoal {
  id                    String                @id @default(cuid())
  name                  String
  description           String?
  goalType              GoalType              @default(TARGET_BASED)
  targetAmount          String
  targetDate            DateTime?
  expectedMonthlyAmount String
  currentBalance        String                @default("0")
  status                GoalStatus            @default(ACTIVE)
  category              GoalCategory          @default(PERSONAL)
  startDate             DateTime              @default(now())
  createdAt             DateTime              @default(now())
  updatedAt             DateTime              @updatedAt
  contributions         MonthlyContribution[]

  @@map("savings_goals")
}

model MonthlyContribution {
  id               String      @id @default(cuid())
  savingsGoalId    String
  year             Int
  month            Int
  projectedAmount  String
  actualAmount     String?
  variance         String?
  runningBalance   String
  contributionDate DateTime    @default(now())
  notes            String?
  createdAt        DateTime    @default(now())
  updatedAt        DateTime    @updatedAt
  savingsGoal      SavingsGoal @relation(fields: [savingsGoalId], references: [id], onDelete: Cascade)

  @@unique([savingsGoalId, year, month])
  @@map("monthly_contributions")
}

enum GoalStatus {
  ACTIVE
  COMPLETED
  PAUSED
  CANCELLED
}

enum GoalCategory {
  DEBT_REPAYMENT
  INVESTMENT
  PERSONAL
  EMERGENCY_FUND
  OTHER
}

enum GoalType {
  TARGET_BASED
  CONTINUOUS
}
